<div  id="app" class="col-md-8">
    <h2>编辑文章</h2>
    <div class="form-group">
        <input type="text" class="form-control" v-model="title" placeholder="输入文字标题">
    </div>
    <div class="form-group">
        <textarea class="form-control" rows="20" v-model="content" placeholder="输入文章内容"></textarea>
    </div>
    <div class="form-group">
        <button class="btn btn-warning" @click="edit(id)">提交</button>
        <button class="btn btn-secondary" @click="cancelEdit(id)">取消</button>
    </div>
</div>
<script>
// `res.render('edit', { id })`传入的id
var postId = '<%= id %>';

const smile = new Smile({
    // data:{
    //   title: '',
    //   content: ''
    // },
    // created () {
    //     axios.get ('/api/v1/posts/' + postId)
    //         .then(function(response) {
    //             vm.title = response.data.post.title;
    //             vm.content = response.data.post.content;
    //         })
    //         .catch(function (err) {
    //             alert(err);
    //         })
    // },
//     methods: {
//         edit (postId) {
//             axios.patch('/api/v1/posts/' + postId,
//                 {
//                     title: vm.title,
//                     content: vm.content
//                 })
//                 .then(function (response) {
//                     return response.data;
//                 })
//                 .then(function (data) {
//                     // 修改文章后，用既有的postId来跳转到文章页面
//                     window.location = '/posts/show?id=' + postId;
//                 })
//                 .catch(function(err) {
//                     alert(err.response.data.error);
//                 })
//         },
//         cancelEdit (postId) {
//             window.location = '/posts/show?id=' + postId;
//         }
//     }
});

smile.getPost(postId)
    .then(function (result) {
        this.title = this.post.title || '';
        this.content = this.post.content;
    }.bind(smile))
    .catch(function(err){
        alert(err);
    });
</script>
